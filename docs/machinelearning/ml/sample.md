# 第八章：采样


采样（Sampling）是机器学习和数据分析中常用的技术，用于从大规模数据集中选取一个代表性子集，方便训练模型或进行统计推断。合理的采样方法可以有效减少计算成本，同时保证模型性能。

---

### 1️⃣ 采样的基本概念

- **样本（Sample）**：从总体中抽取的一部分数据。
- **总体（Population）**：研究的全体数据集合。
- **采样目的**：
  - 降低计算资源消耗
  - 减少数据不平衡影响
  - 提高模型训练效率

---

### 2️⃣ 常见采样方法

#### 2.1 简单随机采样（Simple Random Sampling）

- 每个样本被选中的概率相等，独立随机抽取。
- 适用于数据均匀分布，无类别不平衡。

#### 2.2 分层采样（Stratified Sampling）

- 先将数据按类别或某特征分层，再按比例从每层抽样。
- 保证采样数据的类别比例和总体一致，适合类别不平衡的数据。

#### 2.3 系统采样（Systematic Sampling）

- 先随机选取一个起始点，然后按照固定间隔选取样本。
- 简单高效，但对数据有周期性可能引起偏差。

#### 2.4 过采样（Oversampling）

- 针对类别不平衡，通过复制少数类样本或生成新样本（如SMOTE）来增加少数类样本数。
- 解决类别极度不平衡问题。

#### 2.5 欠采样（Undersampling）

- 通过减少多数类样本数量，达到类别平衡。
- 可能会丢失部分有用信息。

---

### 3️⃣ 采样代码示例（Python）

```python
from sklearn.model_selection import train_test_split
from collections import Counter
import numpy as np

# 模拟数据及标签
X = np.arange(1000).reshape((1000, 1))
y = np.array([0]*900 + [1]*100)  # 类别不平衡

# 3.1 简单随机采样：随机划分训练测试集
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42)

print(f"训练集类别分布: {Counter(y_train)}")
print(f"测试集类别分布: {Counter(y_test)}")

# 3.2 分层采样：保持类别比例不变
X_train_strat, X_test_strat, y_train_strat, y_test_strat = train_test_split(
    X, y, test_size=0.2, random_state=42, stratify=y)

print(f"分层采样训练集类别分布: {Counter(y_train_strat)}")
print(f"分层采样测试集类别分布: {Counter(y_test_strat)}")
```

### 4️⃣ 采样技巧和注意事项


- **保持数据代表性**：采样后样本应尽可能代表整体数据特征。
- **处理类别不平衡**：用分层采样或过采样、欠采样方法。
- **避免数据泄漏**：训练测试集划分要先完成，防止训练集信息泄露到测试集。
- **采样比例合理**：采样过少会导致模型欠拟合，过多则无法降低计算负担。

### 5️⃣ 总结

| 采样方法     | 优点                     | 缺点                      | 适用场景                    |
|--------------|--------------------------|---------------------------|-----------------------------|
| 简单随机采样 | 简单易用，均匀抽样        | 不适合类别不平衡          | 数据均匀，样本量较大        |
| 分层采样     | 保证类别比例，代表性好     | 实现稍复杂                | 类别分布不均，需保留类别比例 |
| 系统采样     | 实现简单，计算高效         | 可能引入周期性偏差        | 数据无明显周期性            |
| 过采样       | 解决少数类样本不足         | 可能过拟合                | 类别极度不平衡             |
| 欠采样       | 减少数据量，提高训练速度   | 可能丢失信息              | 多数类样本过多             |