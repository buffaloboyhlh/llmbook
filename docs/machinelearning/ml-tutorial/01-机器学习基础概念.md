# ç¬¬ä¸€ç« ï¼šæœºå™¨å­¦ä¹ åŸºç¡€æ¦‚å¿µ

## ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ ï¼Ÿ

æœºå™¨å­¦ä¹ ï¼ˆMachine Learning, MLï¼‰ï¼šé€šè¿‡ç®—æ³•è®©è®¡ç®—æœºä»æ•°æ®ä¸­è‡ªåŠ¨å­¦ä¹ è§„å¾‹ï¼Œå¹¶åˆ©ç”¨å­¦ä¹ åˆ°çš„æ¨¡å‹è¿›è¡Œé¢„æµ‹æˆ–å†³ç­–ï¼Œè€Œæ— éœ€æ˜¾å¼ç¼–ç¨‹ã€‚

## ç›‘ç£å­¦ä¹  vs éç›‘ç£å­¦ä¹  vs å¼ºåŒ–å­¦ä¹ 


### ç›‘ç£å­¦ä¹  (Supervised Learning)
- **å®šä¹‰**: åœ¨ç›‘ç£å­¦ä¹ ä¸­ï¼Œæ¨¡å‹é€šè¿‡å¸¦æ ‡ç­¾çš„æ•°æ®é›†è¿›è¡Œè®­ç»ƒã€‚æ¯ä¸ªè¾“å…¥æ•°æ®éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„è¾“å‡ºæ ‡ç­¾ã€‚
- **åº”ç”¨ç¤ºä¾‹**: å›¾åƒåˆ†ç±»ã€åƒåœ¾é‚®ä»¶æ£€æµ‹ã€æˆ¿ä»·é¢„æµ‹ç­‰ã€‚
- **ä¼˜ç‚¹**: å‡†ç¡®æ€§é«˜ï¼Œé€‚ç”¨äºå·²çŸ¥ç±»åˆ«çš„æƒ…å†µã€‚
- **ç¼ºç‚¹**: éœ€è¦å¤§é‡çš„æ ‡æ³¨æ•°æ®ï¼Œæˆæœ¬è¾ƒé«˜ã€‚

### éç›‘ç£å­¦ä¹  (Unsupervised Learning)
- **å®šä¹‰**: éç›‘ç£å­¦ä¹ ä½¿ç”¨æ²¡æœ‰æ ‡ç­¾çš„æ•°æ®é›†è¿›è¡Œè®­ç»ƒã€‚æ¨¡å‹è¯•å›¾ä»æ•°æ®ä¸­å‘ç°æ½œåœ¨çš„æ¨¡å¼æˆ–ç»“æ„ã€‚
- **åº”ç”¨ç¤ºä¾‹**: èšç±»åˆ†æã€é™ç»´ï¼ˆPCAï¼‰ã€æ¨èç³»ç»Ÿç­‰ã€‚
- **ä¼˜ç‚¹**: æˆæœ¬è¾ƒä½ï¼Œé€‚ç”¨äºæœªçŸ¥ç»“æ„çš„æ•°æ®ã€‚
- **ç¼ºç‚¹**: ç»“æœè§£é‡Šéš¾åº¦è¾ƒå¤§ï¼Œå¯èƒ½ä¸å¦‚ç›‘ç£å­¦ä¹ å‡†ç¡®ã€‚

### å¼ºåŒ–å­¦ä¹  (Reinforcement Learning)
- **å®šä¹‰**: å¼ºåŒ–å­¦ä¹ æ˜¯ä¸€ç§è¯•é”™çš„å­¦ä¹ æ–¹æ³•ã€‚æ™ºèƒ½ä½“åœ¨ç¯å¢ƒä¸­æ‰§è¡ŒåŠ¨ä½œï¼Œå¹¶æ ¹æ®ç¯å¢ƒåé¦ˆçš„å¥–åŠ±ä¿¡å·è°ƒæ•´ç­–ç•¥ä»¥æœ€å¤§åŒ–ç´¯ç§¯å¥–åŠ±ã€‚
- **åº”ç”¨ç¤ºä¾‹**: æ¸¸æˆAIã€æœºå™¨äººæ§åˆ¶ã€è‡ªåŠ¨é©¾é©¶ç­‰ã€‚
- **ä¼˜ç‚¹**: é€‚ç”¨äºåŠ¨æ€ç¯å¢ƒï¼Œèƒ½å¤Ÿå¤„ç†å¤æ‚çš„å†³ç­–é—®é¢˜ã€‚
- **ç¼ºç‚¹**: è®­ç»ƒæ—¶é—´é•¿ï¼Œéœ€è¦æ¨¡æ‹Ÿå¤§é‡ç¯å¢ƒäº’åŠ¨ã€‚

## æ¨¡å‹è¯„ä¼°ï¼šå‡†ç¡®ç‡ã€ç²¾ç¡®ç‡ã€å¬å›ç‡ã€F1 å€¼

### åˆ†ç±»æŒ‡æ ‡

åˆ†ç±»ç»“æœ åœ¨æ·±å…¥ç ”ç©¶åˆ†ç±»æŒ‡æ ‡ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»äº†è§£ä»¥ä¸‹æ¦‚å¿µï¼š

+ çœŸæ­£ä¾‹ (TP)ï¼šæ¨¡å‹æ­£ç¡®é¢„æµ‹æ­£ç±»çš„æƒ…å†µã€‚
+ å‡æ­£ä¾‹ (FP)ï¼šæ¨¡å‹é¢„æµ‹ä¸ºæ­£ç±»ï¼Œä½†å®é™…ç±»ä¸ºè´Ÿç±»çš„æƒ…å†µã€‚
+ çœŸåä¾‹ (TN)ï¼šæ¨¡å‹æ­£ç¡®é¢„æµ‹è´Ÿç±»çš„æƒ…å†µã€‚
+ å‡åä¾‹ (FN)ï¼šæ¨¡å‹é¢„æµ‹ä¸ºé˜´æ€§ç±»åˆ«ï¼Œä½†å®é™…ç±»åˆ«ä¸ºé˜³æ€§çš„æƒ…å†µã€‚

#### å‡†ç¡®åº¦ 

å‡†ç¡®ç‡æ˜¯æœ€ç›´æ¥çš„åˆ†ç±»æŒ‡æ ‡ï¼Œè¡¡é‡æ­£ç¡®é¢„æµ‹çš„æ¯”ä¾‹ã€‚è™½ç„¶å‡†ç¡®ç‡æ˜“äºç†è§£å’Œè®¡ç®—ï¼Œä½†åœ¨ç±»åˆ«ä¸å¹³è¡¡çš„æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šäº§ç”Ÿè¯¯å¯¼ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè€ƒè™‘å…¶ä»–æŒ‡æ ‡æ˜¯è‡³å…³é‡è¦çš„ã€‚

![accuracy.png](../../imgs/ml/accuracy.png)

+ æ˜“äºç†è§£å’Œæ²Ÿé€šï¼Œå¹¶æä¾›å¯¹æ¨¡å‹æ€§èƒ½çš„ç®€å•è¯„ä¼°ã€‚
+ ä¸é€‚åˆä¸å¹³è¡¡çš„ç±»åˆ«ï¼Œå› ä¸ºå®ƒå¯èƒ½æœ‰åˆ©äºå¤šæ•°ç±»åˆ«ã€‚
+ æ— æ³•åŒºåˆ†å‡é˜³æ€§å’Œå‡é˜´æ€§ã€‚
+ åº”ä¸å…¶ä»–æŒ‡æ ‡ç»“åˆä½¿ç”¨ã€‚

è¿™æ˜¯ä¸€ç§åœ¨ Python ä¸­è®¡ç®—å‡†ç¡®åº¦å¾—åˆ†çš„æ–¹æ³•ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç å°†æ¨¡å‹é¢„æµ‹çš„å€¼ ( y_pred ) ä¸çœŸå®å€¼ ( y_test ) è¿›è¡Œæ¯”è¾ƒï¼š

```python
from sklearn.metrics import precision_score 
# è®¡ç®—æ¨¡å‹çš„ç²¾ç¡®åº¦å¾—åˆ†

model_precision = precision_score(y_test, y_pred) 

print("Precision:", model_precision)

```

#### æ··æ·†çŸ©é˜µ

æ··æ·†çŸ©é˜µæ˜¯ä¸€ä¸ªè¡¨æ ¼ï¼Œæ€»ç»“äº†åˆ†ç±»æ¨¡å‹çš„è¡¨ç°ï¼Œé€šè¿‡æ¯”è¾ƒé¢„æµ‹å€¼å’Œå®é™…å€¼ã€‚å®ƒä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªæ¨¡å‹è¡¨ç°çš„ç›´è§‚è¡¨ç¤ºï¼Œå¸®åŠ©è¯†åˆ«æ¨¡å‹çš„é”™è¯¯ä¹‹å¤„ã€‚å®ƒæ˜¾ç¤ºäº†æˆ‘ä»¬çš„æ‰€æœ‰å››ä¸ªåˆ†ç±»ç»“æœã€‚æ··æ·†çŸ©é˜µæä¾›äº†æ¨¡å‹æ€§èƒ½çš„ç›´è§‚è¡¨ç¤ºï¼Œå¹¶æœ‰åŠ©äºè¯†åˆ«æ¨¡å‹åœ¨å“ªé‡ŒçŠ¯äº†é”™è¯¯ã€‚

![matrix.png](../../imgs/ml/matrix.png)

+ æä¾›çœŸé˜³æ€§ã€å‡é˜³æ€§ã€çœŸé˜´æ€§å’Œå‡é˜´æ€§çš„è¯¦ç»†åˆ†ç±»ã€‚
+ æ·±å…¥äº†è§£æ¯ä¸ªç±»åˆ«çš„æ¨¡å‹æ€§èƒ½ï¼Œæœ‰åŠ©äºè¯†åˆ«å¼±ç‚¹å’Œåå·®ã€‚
+ ä½œä¸ºè®¡ç®—å„ç§æŒ‡æ ‡çš„åŸºç¡€ï¼Œä¾‹å¦‚ç²¾ç¡®åº¦ã€å¬å›ç‡ã€F1 åˆ†æ•°å’Œå‡†ç¡®åº¦ã€‚
+ å¯èƒ½æ›´éš¾ä»¥è§£é‡Šå’Œæ²Ÿé€šï¼Œå› ä¸ºå®ƒä¸æä¾›æ•´ä½“æ¨¡å‹æ€§èƒ½çš„å•ä¸€å€¼ï¼ˆå‡ºäºæ¯”è¾ƒç›®çš„å¯èƒ½éœ€è¦è¯¥å€¼ï¼‰ã€‚

åœ¨ Python ä¸­ç»˜åˆ¶æ··æ·†çŸ©é˜µçš„ä¸€ç§ç®€å•æ–¹æ³•æ˜¯ï¼š

```python
from sklearn.metrics import confusion_matrix, ConfusionMatrixDisplay

# è®¡ç®—æ··æ·†çŸ©é˜µ
conf_matrix = confusion_matrix(y_test, y_pred)

# å±•ç¤ºæ··æ·†çŸ©é˜µ
disp = ConfusionMatrixDisplay(confusion_matrix=conf_matrix, display_labels=model.classes_)
disp.plot()

```

#### ç²¾ç¡®åº¦

ç²¾ç¡®åº¦ï¼Œå°±æ˜¯æˆ‘ä»¬æ¨¡å‹é¢„æµ‹å‡ºæ¥çš„æ­£ç±»ä¸­æ‰€å çš„ä»½é¢ã€‚

![process.png](../../imgs/ml/process.png)

è¿™ä¸ªæŒ‡æ ‡ï¼Œç‰¹åˆ«åœ¨é‚£äº›æŠŠå‡é˜³æ€§çœ‹å¾—æ¯”è¾ƒé‡çš„åœºæ™¯ä¸‹æ ¼å¤–é‡è¦ï¼Œæ¯”å¦‚è¯´è¿‡æ»¤åƒåœ¾é‚®ä»¶æˆ–è€…æ˜¯åŒ»å­¦ä¸Šçš„è¯Šæ–­ã€‚ä½†å…‰æœ‰ç²¾ç¡®åº¦è¿˜ä¸å¤Ÿï¼Œå› ä¸ºå®ƒæ²¡åŠæ³•å‘Šè¯‰æˆ‘ä»¬å‡é˜´æ€§çš„æƒ…å†µï¼Œæ‰€ä»¥ä¸€èˆ¬ä¼šè·Ÿå¬å›ç‡ä¸€èµ·æ­é…ä½¿ç”¨ã€‚

+ åœ¨è¯¯æŠ¥çš„ä»£ä»·ç‰¹åˆ«å¤§çš„æƒ…å†µä¸‹ï¼Œç²¾ç¡®åº¦å°±æ˜¾å¾—å°¤ä¸ºå…³é”®äº†ã€‚
+ æ˜“äºç†è§£å’Œæ²Ÿé€šã€‚
+ ä½†å®ƒå°±æ˜¯ä¸æ¶‰åŠé‚£äº›è¢«æ¨¡å‹é”™è¿‡çš„æ­£ç±»ï¼Œå³å‡é˜´æ€§çš„æ•°é‡ã€‚
+ é€‚ç”¨äºä¸å¹³è¡¡æ•°æ®ã€‚ä½†æ˜¯ï¼Œå®ƒåº”è¯¥ä¸å…¶ä»–æŒ‡æ ‡ç»“åˆä½¿ç”¨ï¼Œå› ä¸ºé«˜ç²¾åº¦å¯èƒ½ä¼šä»¥ç‰ºç‰²ä¸å¹³è¡¡æ•°æ®é›†çš„å¬å›ç‡ä¸ºä»£ä»·

#### å¬å›ç‡

å¬å›ç‡ï¼ˆçµæ•åº¦ï¼‰ å¬å›ç‡ï¼Œä¹Ÿå«çµæ•åº¦ï¼Œæ˜¯è¯„ä¼°åœ¨æ‰€æœ‰çœŸæ­£çš„æ­£ä¾‹ä¸­ï¼Œæœ‰å¤šå°‘è¢«æˆ‘ä»¬çš„æ¨¡å‹æ­£ç¡®è¯†åˆ«å‡ºæ¥çš„æ¯”ä¾‹ã€‚

![recall.png](../../imgs/ml/recall.png)

åœ¨é‚£äº›é”™è¿‡çœŸé˜³æ€§çš„ä»£ä»·æå…¶é‡å¤§çš„åœºåˆâ€”â€”æ¯”å¦‚ç™Œç—‡ç­›æŸ¥æˆ–è€…é˜²èŒƒä¿¡ç”¨è¯ˆéª—ï¼Œæˆ–æ˜¯åœ¨é‚£ç§æ­£ç±»ç›¸å¯¹è¾ƒå°‘çš„æ•°æ®é›†é‡Œâ€”â€”å¬å›ç‡çš„é‡è¦æ€§ä¸è¨€è€Œå–»ã€‚æ­£å¦‚å¬å›ç‡éœ€è¦å’Œç²¾ç¡®ç‡ä¸€æ ·çš„æ­æ¡£ä¸€æ ·ï¼Œä¸ºäº†è¾¾åˆ°ä¸€ç§è¯„ä¼°çš„å¹³è¡¡ï¼Œå¬å›ç‡ä¹Ÿéœ€è¦å’Œå…¶ä»–æŒ‡æ ‡ä¸€å¹¶å‚è€ƒã€‚

+ åœ¨é”™å¤±çœŸé˜³æ€§çš„åæœéå¸¸ä¸¥é‡æ—¶ï¼Œå¬å›ç‡æ˜¾å¾—æ ¼å¤–å…³é”®ã€‚
+ æ˜“äºç†è§£å’Œæ²Ÿé€šã€‚
+ ä¸è€ƒè™‘è¯¯æŠ¥çš„æ•°é‡ã€‚
+ é€‚ç”¨äºä¸å¹³è¡¡æ•°æ®ã€‚ç„¶è€Œï¼Œå®ƒåº”è¯¥ä¸å…¶ä»–æŒ‡æ ‡ç»“åˆèµ·æ¥ï¼Œå› ä¸ºé«˜å¬å›ç‡å¯èƒ½ä¼šä»¥ç‰ºç‰²ä¸å¹³è¡¡æ•°æ®é›†çš„ç²¾åº¦ä¸ºä»£ä»·ã€‚

#### F1-åˆ†æ•°

F1 åˆ†æ•°æ˜¯ç²¾ç¡®ç‡å’Œå¬å›ç‡çš„è°ƒå’Œå¹³å‡å€¼ï¼Œæä¾›äº†å¹³è¡¡ä¸¤è€…çš„å•ä¸€æŒ‡æ ‡ã€‚

![F1.png](../../imgs/ml/F1.png)

å½“è¯¯æŠ¥å’Œæ¼æŠ¥åŒæ ·é‡è¦å¹¶ä¸”æ‚¨å¯»æ±‚ç²¾ç¡®ç‡å’Œå¬å›ç‡ä¹‹é—´çš„å¹³è¡¡æ—¶ï¼ŒF1 åˆ†æ•°éå¸¸æœ‰ç”¨ã€‚

+ F1-Score å¹³è¡¡ç²¾ç¡®åº¦å’Œå¬å›ç‡ï¼šå½“è¯¯æŠ¥å’Œæ¼æŠ¥éƒ½å¾ˆé‡è¦æ—¶å¾ˆæœ‰ç”¨ã€‚
+ å¯¹äºä¸å¹³è¡¡çš„æ•°æ®ç‰¹åˆ«æœ‰ç”¨ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œéœ€è¦åœ¨ç²¾ç¡®åº¦å’Œå¬å›ç‡ä¹‹é—´è¿›è¡Œæƒè¡¡ã€‚
+ åå‘äºå…·æœ‰ç›¸ä¼¼ç²¾åº¦å’Œå¬å›ç‡çš„æ¨¡å‹ï¼Œè¿™å¯èƒ½å¹¶ä¸æ€»æ˜¯ä»¤äººæ»¡æ„çš„ã€‚
+ å¯èƒ½ä¸è¶³ä»¥æ¯”è¾ƒä¸åŒæ¨¡å‹çš„æ€§èƒ½ï¼Œç‰¹åˆ«æ˜¯å½“æ¨¡å‹åœ¨è¯¯æŠ¥å’Œæ¼æŠ¥ä¹‹é—´å…·æœ‰ä¸åŒçš„æƒè¡¡æ—¶ã€‚

ä¸€æ¬¡æ€§è·å¾—å‡†ç¡®ç‡ã€å¬å›ç‡å’Œ F1 åˆ†æ•°çš„æœ€ç®€å•æ–¹æ³•æ˜¯ä½¿ç”¨ scikit-learn çš„åˆ†ç±»æŠ¥å‘Šï¼š

```python
from sklearn.metrics import classification_report  # ä¿®æ­£å¯¼å…¥è¯­å¥ï¼Œåº”è¯¥åœ¨importå’Œclassification_reportä¹‹é—´åŠ ä¸Šç©ºæ ¼

# ç”Ÿæˆåˆ†ç±»æŠ¥å‘Š
# è¯¥æŠ¥å‘ŠåŒ…æ‹¬äº†ç²¾ç¡®åº¦ã€å¬å›ç‡ã€F1åˆ†æ•°ç­‰å…³é”®æŒ‡æ ‡
class_report = classification_report(y_test, y_pred) 

# æ‰“å°åˆ†ç±»æŠ¥å‘Š
print(class_report)

```

#### å·¥ä½œç‰¹æ€§æ›²çº¿ä¸‹é¢ç§¯ï¼ˆAUCï¼‰

AUCè¡¡é‡çš„æ˜¯åœ¨ä¸åŒçš„åˆ¤å®šé—¨æ§›ä¸‹ï¼Œæ¨¡å‹è¯†åˆ«æ­£ç±»çš„èƒ½åŠ›ä¸è¯¯å°†è´Ÿç±»åˆ¤ä¸ºæ­£ç±»çš„é£é™©ä¹‹é—´çš„å¹³è¡¡ã€‚AUCå€¼æ»¡åˆ†ä¸º1ï¼Œä»£è¡¨æ¨¡å‹é¢„æµ‹èƒ½åŠ›æ— æ‡ˆå¯å‡»ï¼Œè€Œå¾—åˆ†ä¸º0.5åˆ™æ„å‘³ç€æ¨¡å‹çš„é¢„æµ‹ä¸è¿‡æ˜¯ç¢°è¿æ°”ã€‚åœ¨è¯„ä¼°å’Œæ¯”è¾ƒå¤šä¸ªæ¨¡å‹çš„è¡¨ç°æ—¶ï¼ŒAUCå°¤å…¶æœ‰ä»·å€¼ï¼Œä½†ä¸ºäº†æ·±å…¥æŒæ¡æ¯ä¸ªæ¨¡å‹åœ¨å„ä¸ªæ–¹é¢çš„ä¼˜åŠ£ï¼Œæœ€å¥½è¿˜æ˜¯å°†å®ƒä¸å…¶ä»–æ€§èƒ½æŒ‡æ ‡ä¸€å¹¶å‚è€ƒã€‚

![auc.png](../../imgs/ml/auc.png)

+ è¯„ä¼°å„ç§åˆ†ç±»é˜ˆå€¼çš„æ¨¡å‹æ€§èƒ½ã€‚
+ é€‚ç”¨äºä¸å¹³è¡¡çš„æ•°æ®é›†ã€‚
+ å¯ç”¨äºæ¯”è¾ƒä¸åŒæ¨¡å‹çš„æ€§èƒ½ã€‚
+ å‡è®¾è¯¯æŠ¥å’Œæ¼æŠ¥å…·æœ‰ç›¸åŒçš„æˆæœ¬ã€‚
+ éæŠ€æœ¯åˆ©ç›Šç›¸å…³è€…éš¾ä»¥è§£é‡Šï¼Œå› ä¸ºå®ƒéœ€è¦äº†è§£ ROC æ›²çº¿ã€‚
+ å¯èƒ½ä¸é€‚åˆå…·æœ‰å°‘é‡è§‚æµ‹å€¼çš„æ•°æ®é›†æˆ–å…·æœ‰å¤§é‡ç±»åˆ«çš„æ¨¡å‹ã€‚

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç è®¡ç®— AUC åˆ†æ•°å¹¶ç»˜åˆ¶ ROC æ›²çº¿ï¼š

```python
# ä»sklearn.metricsæ¨¡å—å¯¼å…¥roc_auc_scoreå’Œroc_curveå‡½æ•°ç”¨äºè®¡ç®—AUCåˆ†æ•°å’Œç»˜åˆ¶ROCæ›²çº¿ï¼ŒåŒæ—¶å¯¼å…¥matplotlib.pyplotç”¨äºç»˜å›¾
from sklearn.metrics import roc_auc_score, roc_curve 
import matplotlib.pyplot as plt 

# ä½¿ç”¨æ¨¡å‹å¯¹æµ‹è¯•é›†X_testè¿›è¡Œæ¦‚ç‡é¢„æµ‹ï¼Œå–æ­£ç±»é¢„æµ‹æ¦‚ç‡ä¸ºçœŸé˜³æ€§ç‡çš„ä¾æ®
y_pred_proba = my_model.predict_proba(X_test)[:, 1] 

# åˆ©ç”¨çœŸå®æ ‡ç­¾y_testå’Œé¢„æµ‹æ¦‚ç‡y_pred_probaè®¡ç®—AUCåˆ†æ•°ï¼Œè¯„ä¼°æ¨¡å‹çš„æ•´ä½“æ€§èƒ½
auc_score = roc_auc_score(y_test, y_pred_proba) 

# åŸºäºçœŸå®æ ‡ç­¾å’Œé¢„æµ‹æ¦‚ç‡ï¼Œè®¡ç®—ROCæ›²çº¿çš„å‡é˜³æ€§ç‡ï¼ˆfprï¼‰å’ŒçœŸé˜³æ€§ç‡ï¼ˆtprï¼‰ï¼ŒåŠä¸åŒé˜ˆå€¼
fpr, tpr, Thresholds = roc_curve(y_test, y_pred_proba) 

# ä½¿ç”¨matplotlibç»˜åˆ¶ROCæ›²çº¿ï¼Œå±•ç¤ºæ¨¡å‹çš„æ€§èƒ½ã€‚æ›²çº¿ä¸‹çš„é¢ç§¯ï¼ˆAUCï¼‰è¶Šå¤§ï¼Œæ¨¡å‹æ€§èƒ½è¶Šå¥½
plt.plot(fpr, tpr, label='My Model (AUC = %0.2f)' % auc_score) 

# ç»˜åˆ¶å¯¹è§’çº¿ï¼Œè¡¨ç¤ºéšæœºçŒœæµ‹çš„æ€§èƒ½æ°´å¹³ï¼Œä½œä¸ºæ€§èƒ½çš„åŸºå‡†çº¿
plt.plot([0, 1], [0, 1], 'k--') 

# è®¾å®šå›¾åƒçš„xè½´å’Œyè½´çš„æ˜¾ç¤ºèŒƒå›´
plt.xlim([0.0, 1.0]) 
plt.ylim([0.0, 1.05]) 

# è®¾ç½®xè½´æ ‡ç­¾ä¸ºâ€œè¯¯æŠ¥ç‡â€å’Œyè½´æ ‡ç­¾ä¸ºâ€œçœŸé˜³æ€§ç‡â€ï¼Œå³ROCæ›²çº¿çš„æ ‡å‡†è½´æ ‡ç­¾
plt.xlabel('è¯¯æŠ¥ç‡') 
plt.ylabel('çœŸé˜³æ€§ç‡') 

# è®¾ç½®å›¾è¡¨æ ‡é¢˜ä¸ºâ€œæ¥æ”¶å™¨æ“ä½œç‰¹å¾â€ï¼Œå³ROCæ›²çº¿çš„å¸¸è§åç§°
plt.title('æ¥æ”¶å™¨æ“ä½œç‰¹å¾') 

# æ·»åŠ å›¾ä¾‹ï¼Œä½äºå›¾çš„å³ä¸‹è§’ï¼Œå±•ç¤ºæ¨¡å‹åŠå…¶AUCåˆ†æ•°
plt.legend(loc="lower right") 

# æ˜¾ç¤ºç»˜åˆ¶çš„å›¾åƒ
plt.show()

```

#### å¯¹æ•°æŸå¤±ï¼ˆäº¤å‰ç†µæŸå¤±)

å¯¹æ•°æŸå¤±ç”¨æ¥è¯„ä¼°æ¨¡å‹é¢„æµ‹å‡†ç¡®æ€§çš„ä¸€ç§æ–¹æ³•ï¼Œå®ƒå¯¹æ¯æ¬¡é¢„æµ‹çš„æ­£ç¡®ä¸å¦è¿›è¡Œå¥–æƒ©ã€‚ è¿™ç§åº¦é‡æ–¹å¼é€šè¿‡æƒ©ç½šé”™è¯¯çš„é¢„æµ‹åŒæ—¶å¥–åŠ±æ­£ç¡®çš„é¢„æµ‹æ¥å·¥ä½œã€‚å¦‚æœå¯¹æ•°æŸå¤±çš„å€¼è¶Šä½ï¼Œæ„å‘³ç€æ¨¡å‹çš„æ€§èƒ½è¶Šå¥½ï¼Œè€Œå½“è¿™ä¸ªå€¼è¾¾åˆ°0æ—¶ï¼Œå°±ä»£è¡¨è¿™ä¸ªæ¨¡å‹èƒ½å¤Ÿå®Œç¾åœ°è¿›è¡Œåˆ†ç±»ã€‚

![croos_loss.png](../../imgs/ml/croos_loss.png)

+ Næ˜¯è§‚æµ‹å€¼çš„æ•°é‡ã€‚
+ y_testæ˜¯äºŒå…ƒåˆ†ç±»é—®é¢˜çš„çœŸå®æ ‡ç­¾ï¼ˆ0 æˆ– 1ï¼‰ã€‚
+ y_probæ˜¯æ ‡ç­¾ä¸º 1 çš„é¢„æµ‹æ¦‚ç‡ã€‚

å½“ä½ éœ€è¦å¯¹æ¨¡å‹çš„æ¦‚ç‡é¢„æµ‹è¿›è¡Œè¯„ä¼°æ—¶ï¼Œæ¯”å¦‚åœ¨åº”ç”¨é€»è¾‘å›å½’æˆ–è€…ç¥ç»ç½‘ç»œæ¨¡å‹çš„æƒ…å†µä¸‹ï¼Œå¯¹æ•°æŸå¤±å°±æ˜¾å¾—å°¤ä¸ºé‡è¦äº†ã€‚ ä¸ºäº†èƒ½æ›´æ·±å…¥åœ°æŒæ¡æ¨¡å‹åœ¨å„ä¸ªåˆ†ç±»ä¸Šçš„è¡¨ç°ï¼Œæœ€å¥½æ˜¯å°†å¯¹æ•°æŸå¤±ä¸å…¶ä»–è¯„ä¼°æŒ‡æ ‡ä¸€èµ·è€ƒè™‘ä½¿ç”¨ã€‚

+ æ¦‚ç‡é¢„æµ‹ï¼šè¡¡é‡è¾“å‡ºæ¦‚ç‡ä¼°è®¡çš„æ¨¡å‹çš„æ€§èƒ½ï¼Œé¼“åŠ±ç»è¿‡è‰¯å¥½æ ¡å‡†çš„é¢„æµ‹ã€‚
+ å¯¹æ•°æŸå¤±å¯ç”¨äºæ¯”è¾ƒä¸åŒæ¨¡å‹çš„æ€§èƒ½æˆ–ä¼˜åŒ–å•ä¸ªæ¨¡å‹çš„æ€§èƒ½ã€‚
+ é€‚ç”¨äºä¸å¹³è¡¡æ•°æ®ã€‚
+ å¯¹æç«¯æ¦‚ç‡é¢„æµ‹é«˜åº¦æ•æ„Ÿï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´é”™è¯¯åˆ†ç±»å®ä¾‹çš„å·¨å¤§æƒ©ç½šå€¼ã€‚
+ å¯èƒ½éš¾ä»¥å‘éæŠ€æœ¯åˆ©ç›Šç›¸å…³è€…è§£é‡Šå’Œæ²Ÿé€šã€‚

### å›å½’æŒ‡æ ‡

#### å¹³å‡ç»å¯¹è¯¯å·®ï¼ˆMAEï¼‰

å¹³å‡ç»å¯¹è¯¯å·®ï¼ˆMAEï¼‰æ˜¯ç”¨æ¥è®¡ç®—é¢„æµ‹å€¼å’Œå®é™…å€¼ä¹‹é—´å·®è·ç»å¯¹å€¼çš„å¹³å‡é‡ã€‚

![mae.png](../../imgs/ml/mae.png)

+ Næ˜¯æ•°æ®ç‚¹çš„æ•°é‡ã€‚
+ y_predæ˜¯é¢„æµ‹å€¼ã€‚
+ y_testæ˜¯å®é™…å€¼ã€‚

**æ¦‚æ‹¬ï¼š**

+ æ˜“äºè§£é‡Šï¼šè¡¨ç¤ºå¹³å‡è¯¯å·®å¤§å°ã€‚
+ å¯¹å¼‚å¸¸å€¼çš„æ•æ„Ÿåº¦ä½äºå‡æ–¹è¯¯å·® (MSE)ã€‚
+ æ— é”™è¯¯æ–¹å‘ï¼šä¸è¡¨ç¤ºé«˜ä¼°æˆ–ä½ä¼°ã€‚
+ åœ¨æŸäº›æƒ…å†µä¸‹å¯èƒ½æ— æ³•æ•è·æç«¯é”™è¯¯çš„å½±å“ã€‚

```python

from sklearn.metrics import mean_absolute_error  # ä¿®æ­£å‡½æ•°åç§°ï¼Œåº”ä¸ºå°å†™çš„ 'mean_absolute_error'

# è®¡ç®—çœŸå®å€¼ä¸é¢„æµ‹å€¼ä¹‹é—´çš„å¹³å‡ç»å¯¹è¯¯å·® (MAE)
mae = mean_absolute_error(y_true, y_pred)  # è®¡ç®—MAE

# æ‰“å°MAEå€¼ï¼Œä»¥è¯„ä¼°æ¨¡å‹é¢„æµ‹çš„å‡†ç¡®æ€§
print("MAE:", mae)

```

#### å‡æ–¹è¯¯å·®ï¼ˆMSEï¼‰

å‡æ–¹è¯¯å·®ï¼ˆMSEï¼‰ç”¨äºè®¡ç®—é¢„æµ‹å€¼ä¸å®é™…å€¼å·®å¼‚çš„å¹³æ–¹åçš„å¹³å‡æ•°ã€‚

![mse.png](../../imgs/ml/mse.png)

MSEç‰¹åˆ«å¯¹ç¦»ç¾¤å€¼æ•æ„Ÿï¼Œè¿™æ˜¯å› ä¸ºå®ƒå¯¹äºè¾ƒå¤§çš„è¯¯å·®æ–½åŠ äº†æ›´é‡çš„æƒ©ç½šï¼Œè¿œè¶…è¿‡å°è¯¯å·®ã€‚è¿™ä¸€ç‰¹æ€§æ ¹æ®å…·ä½“çš„åº”ç”¨åœºæ™¯ï¼Œæ—¢å¯èƒ½æ˜¯ä¸€ä¸ªä¼˜åŠ¿ä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ªåŠ£åŠ¿ã€‚ æ¦‚æ‹¬ï¼š

+ å¯¹æç«¯é”™è¯¯æ›´åŠ æ•æ„Ÿã€‚
+ å¹³æ–¹è¯¯å·®å€¼å¯èƒ½ä¸å¦‚ç»å¯¹è¯¯å·®ç›´è§‚ã€‚
+ ä¸å¹³å‡ç»å¯¹è¯¯å·® (MAE) ç›¸æ¯”ï¼Œå—å¼‚å¸¸å€¼çš„å½±å“æ›´å¤§ã€‚

#### å‡æ–¹æ ¹è¯¯å·®ï¼ˆRMSEï¼‰

å‡æ–¹æ ¹è¯¯å·® (RMSE) æ˜¯å‡æ–¹è¯¯å·®çš„å¹³æ–¹æ ¹ã€‚

![rmse.png](../../imgs/ml/rmse.png)

RMSEåŒæ ·å¯¹ç¦»ç¾¤å€¼æ•æ„Ÿï¼Œå’ŒMSEä¸€æ ·ï¼Œå¯¹è¾ƒå¤§çš„è¯¯å·®ç»™äºˆè¾ƒé‡çš„æƒ©ç½šã€‚ä¸è¿‡ï¼ŒRMSEçš„ä¸€ä¸ªæ˜¾è‘—ä¼˜åŠ¿åœ¨äºå®ƒçš„å•ä½å’Œç›®æ ‡å˜é‡ä¿æŒä¸€è‡´ï¼Œè¿™ä½¿å¾—RMSEæ›´åŠ æ˜“äºç†è§£å’Œè§£é‡Šã€‚ æ¦‚æ‹¬ï¼š

+ å¯¹æç«¯é”™è¯¯æ›´åŠ æ•æ„Ÿã€‚
+ ä¸ç›®æ ‡å˜é‡ç›¸åŒçš„å•ä½ï¼š
+ ä¸å¹³å‡ç»å¯¹è¯¯å·® (MAE) ç›¸æ¯”ï¼Œå—å¼‚å¸¸å€¼çš„å½±å“æ›´å¤§ã€‚

```python

from sklearn.metrics import mean_squared_error  # æ³¨æ„ä¿®æ­£å¯¼å…¥å‡½æ•°åçš„å¤§å°å†™

# åˆ©ç”¨æ¨¡å‹å¯¹æ•°æ®é›†Xè¿›è¡Œé¢„æµ‹ï¼Œå¾—åˆ°é¢„æµ‹å€¼y_pred
y_pred = model.predict(X) 

# è®¡ç®—å®é™…å€¼yå’Œé¢„æµ‹å€¼y_predä¹‹é—´çš„å‡æ–¹è¯¯å·®ï¼ˆMSEï¼‰
mse = mean_squared_error(y, y_pred)  # æ³¨æ„ä¿®æ­£å‡½æ•°åçš„å¤§å°å†™

# é€šè¿‡å¯¹MSEå–å¹³æ–¹æ ¹ï¼Œè®¡ç®—å‡æ–¹æ ¹è¯¯å·®ï¼ˆRMSEï¼‰ï¼Œè¿™ä¸€æ­¥ä½¿å¾—è¯¯å·®å•ä½ä¸ç›®æ ‡å˜é‡å•ä½ä¸€è‡´
rmse = np.sqrt(mse) 

# è¾“å‡ºå‡æ–¹æ ¹è¯¯å·®ï¼ˆRMSEï¼‰ï¼Œä»¥è¯„ä¼°æ¨¡å‹é¢„æµ‹çš„å‡†ç¡®æ€§
print('Root Mean Squared Error:', rmse)

```

#### å¹³å‡ç»å¯¹ç™¾åˆ†æ¯”è¯¯å·®ï¼ˆMAPEï¼‰

å¹³å‡ç»å¯¹ç™¾åˆ†æ¯”è¯¯å·®ï¼ˆMAPEï¼‰æ˜¯ä¸€ä¸ªè¡¡é‡é¢„æµ‹å‡†ç¡®æ€§çš„æŒ‡æ ‡ï¼Œå®ƒé€šè¿‡è®¡ç®—é¢„æµ‹å€¼ä¸å®é™…å€¼ä¹‹é—´å·®å¼‚çš„ç™¾åˆ†æ¯”ï¼Œç„¶åå–è¿™äº›ç™¾åˆ†æ¯”å·®å¼‚çš„å¹³å‡å€¼æ¥å®ç°ã€‚MAPEçš„è®¡ç®—æ–¹å¼å¯ä»¥è¿™æ ·è¡¨è¾¾ï¼š

![mape.png](../../imgs/ml/mape.png)

åœ¨å¯¹æ¯”ä¸åŒæ¨¡å‹æ€§èƒ½æˆ–åˆ¤æ–­è¯¯å·®çš„é‡è¦ç¨‹åº¦æ—¶ï¼ŒMAPEå±•ç°äº†å…¶ç‹¬åˆ°çš„ä»·å€¼ã€‚ ä½†æ˜¯ï¼Œå½“æ¶‰åŠåˆ°æ¥è¿‘é›¶çš„æ•°å€¼æ—¶ï¼ŒMAPEçš„åº”ç”¨å°±ä¼šé‡åˆ°æŒ‘æˆ˜ï¼Œå› ä¸ºè¿™æ—¶çš„ç™¾åˆ†æ¯”è¯¯å·®å¯èƒ½ä¼šæ¿€å¢ï¼Œå˜å¾—å¼‚å¸¸å·¨å¤§ã€‚

+ ç›¸å¯¹è¯¯å·®æŒ‡æ ‡ï¼šå¯ç”¨äºæ¯”è¾ƒä¸åŒå°ºåº¦çš„æ¨¡å‹æ€§èƒ½ã€‚
+ æ˜“äºè§£é‡Šï¼šä»¥ç™¾åˆ†æ¯”è¡¨ç¤ºã€‚
+ é›¶å€¼æœªå®šä¹‰ï¼Œè¿™å¯èƒ½å‘ç”Ÿåœ¨æŸäº›åº”ç”¨ç¨‹åºä¸­ã€‚
+ ä¸å¯¹ç§°ï¼šé«˜ä¼°å°å®é™…å€¼çš„è¯¯å·®ï¼Œä½ä¼°å¤§å®é™…å€¼çš„è¯¯å·®ã€‚

Scikit learn æ²¡æœ‰ MAPE å‡½æ•°ï¼Œä½†æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•è‡ªå·±è®¡ç®—ï¼š

```python

# å®šä¹‰ä¸€ä¸ªå‡½æ•°æ¥è®¡ç®—å¹³å‡ç»å¯¹ç™¾åˆ†æ¯”è¯¯å·®ï¼ˆMAPEï¼‰
def mape(y_true, y_pred): 
    # è®¡ç®—çœŸå®å€¼ä¸é¢„æµ‹å€¼ä¹‹é—´çš„ç»å¯¹å·®å¼‚ï¼Œç„¶åé™¤ä»¥çœŸå®å€¼ï¼Œæœ€åä¹˜ä»¥100è½¬æ¢ä¸ºç™¾åˆ†æ¯”
    return np.mean(np.abs((y_true - y_pred) / y_true)) * 100

# ä½¿ç”¨å®šä¹‰å¥½çš„MAPEå‡½æ•°ï¼Œä¼ å…¥çœŸå®å€¼y_trueå’Œé¢„æµ‹å€¼y_predï¼Œè®¡ç®—MAPE
mape_value = mape(y_true, y_pred)  # ä¿®æ­£å˜é‡åä»¥é¿å…ä¸å‡½æ•°åç›¸åŒ

# æ‰“å°MAPEå€¼ï¼Œè¯„ä¼°æ¨¡å‹é¢„æµ‹çš„å¹³å‡è¯¯å·®ç™¾åˆ†æ¯”
print("MAPE:", mape_value)  # ä¿®æ­£è¯­æ³•é”™è¯¯

```

#### R å¹³æ–¹ï¼ˆå†³å®šç³»æ•°)

Rå¹³æ–¹è¡¡é‡äº†æ¨¡å‹é¢„æµ‹å€¼ä¸å®é™…å€¼ä¹‹é—´çš„ä¸€è‡´æ€§ï¼Œé€šè¿‡è®¡ç®—æ¨¡å‹èƒ½è§£é‡Šçš„ç›®æ ‡å˜é‡æ–¹å·®çš„æ¯”ä¾‹æ¥è¯„ä¼°ã€‚å…·ä½“æ¥è¯´ï¼ŒRå¹³æ–¹çš„è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š

![r2.png](../../imgs/ml/r2.png)

+ y_meanæ˜¯å®é™…å€¼çš„å¹³å‡å€¼ã€‚
+ y_predæ˜¯é¢„æµ‹å€¼ã€‚
+ y_testæ˜¯å®é™…å€¼ã€‚

Rå¹³æ–¹çš„å–å€¼ä»‹äº0åˆ°1ä¹‹é—´ï¼Œå…¶ä¸­å€¼è¶Šæ¥è¿‘1æ„å‘³ç€æ¨¡å‹çš„é¢„æµ‹èƒ½åŠ›è¶Šå¼ºã€‚ä½†æ˜¯ï¼ŒRå¹³æ–¹ä¹Ÿå­˜åœ¨ä¸€å®šçš„é™åˆ¶ï¼Œæ¯”å¦‚è¯´ï¼Œå³ä½¿åŠ å…¥äº†ä¸ç›®æ ‡å˜é‡æ— å…³çš„ç‰¹å¾ï¼Œå…¶å€¼ä¹Ÿæœ‰å¯èƒ½ä¸Šå‡ã€‚ æ¦‚æ‹¬ï¼š

+ ä»£è¡¨è§£é‡Šæ–¹å·®çš„æ¯”ä¾‹ï¼Œä½¿å…¶æ˜“äºç†è§£å’Œæ²Ÿé€šã€‚
+ å¯¹ç›®æ ‡å˜é‡çš„è§„æ¨¡ä¸å¤ªæ•æ„Ÿï¼Œè¿™ä½¿å¾—å®ƒæ›´é€‚åˆæ¯”è¾ƒä¸åŒæ¨¡å‹çš„æ€§èƒ½ã€‚
+ åå‘äºå…·æœ‰è®¸å¤šåŠŸèƒ½çš„æ¨¡å‹ï¼Œè¿™å¯èƒ½å¹¶ä¸æ€»æ˜¯ä»¤äººæ»¡æ„çš„ã€‚
+ ä¸é€‚åˆè¯„ä¼°é¢„æµ‹å˜é‡å’Œç›®æ ‡å˜é‡ä¹‹é—´ä¸å­˜åœ¨çº¿æ€§å…³ç³»çš„æ¨¡å‹ã€‚
+ å¯èƒ½ä¼šå—åˆ°æ•°æ®ä¸­å¼‚å¸¸å€¼çš„å½±å“ã€‚

```python
from sklearn.metrics import r2_score 


# ä½¿ç”¨r2_scoreå‡½æ•°è®¡ç®—çœŸå®å€¼y_trueå’Œé¢„æµ‹å€¼y_predä¹‹é—´çš„Rå¹³æ–¹å€¼
r_squared = r2_score(y_true, y_pred) 

# è¾“å‡ºRå¹³æ–¹å€¼ï¼Œä»¥è¯„ä¼°æ¨¡å‹è§£é‡Šç›®æ ‡å˜é‡æ–¹å·®çš„èƒ½åŠ›
print("R-squared:", r_squared)

```


#### è°ƒæ•´åçš„ R å¹³æ–¹ï¼ˆAdjusted R-Squaredï¼‰

Adjusted R-Squared æ˜¯å¯¹Rå¹³æ–¹ï¼ˆ R-Squaredï¼‰çš„æ”¹è‰¯ï¼Œå®ƒåœ¨è®¡ç®—è¿‡ç¨‹ä¸­è€ƒè™‘åˆ°äº†æ¨¡å‹ä¸­åŒ…å«çš„ç‰¹å¾æ•°é‡ï¼Œä»è€Œå¯¹æ¨¡å‹å¤æ‚åº¦è¿›è¡Œäº†è°ƒæ•´ã€‚è°ƒæ•´Rå¹³æ–¹çš„è®¡ç®—å…¬å¼æ˜¯è¿™æ ·çš„ï¼š

![adjust-r2.png](../../imgs/ml/adjust-r2.png)

+ Næ˜¯æ•°æ®ç‚¹çš„æ•°é‡ã€‚
+ kæ˜¯ç‰¹å¾çš„æ•°é‡ã€‚

è°ƒæ•´åçš„ R-Squared å¯ä»¥é€šè¿‡æƒ©ç½šå…·æœ‰è¿‡å¤šç‰¹å¾çš„æ¨¡å‹æ¥å¸®åŠ©é˜²æ­¢è¿‡åº¦æ‹Ÿåˆã€‚ æ¦‚æ‹¬ï¼š

+ ä¿®æ”¹ R å¹³æ–¹ï¼Œè°ƒæ•´æ¨¡å‹ä¸­é¢„æµ‹å˜é‡çš„æ•°é‡ï¼Œä½¿å…¶æˆä¸ºæ¯”è¾ƒå…·æœ‰ä¸åŒé¢„æµ‹å˜é‡æ•°é‡çš„æ¨¡å‹æ€§èƒ½çš„æ›´åˆé€‚çš„æŒ‡æ ‡ã€‚
+ å¯¹ç›®æ ‡å˜é‡çš„è§„æ¨¡ä¸å¤ªæ•æ„Ÿï¼Œè¿™ä½¿å¾—å®ƒæ›´é€‚åˆæ¯”è¾ƒä¸åŒæ¨¡å‹çš„æ€§èƒ½ã€‚
+ æƒ©ç½šé¢å¤–å˜é‡ï¼šä¸ R å¹³æ–¹ç›¸æ¯”ï¼Œé™ä½è¿‡åº¦æ‹Ÿåˆé£é™©ã€‚
+ ä¸é€‚åˆè¯„ä¼°é¢„æµ‹å˜é‡å’Œç›®æ ‡å˜é‡ä¹‹é—´ä¸å­˜åœ¨çº¿æ€§å…³ç³»çš„æ¨¡å‹ã€‚
+ å¯èƒ½ä¼šå—åˆ°æ•°æ®ä¸­å¼‚å¸¸å€¼çš„å½±å“ã€‚

```python

from sklearn.metrics import r2_score 

# è®¡ç®—æ¨¡å‹çš„Rå¹³æ–¹å€¼ï¼Œå³æ¨¡å‹çš„è§£é‡Šèƒ½åŠ›
r_squared = r2_score(y, y_pred) 

# ä¸ºäº†æ›´å‡†ç¡®åœ°è¯„ä¼°æ¨¡å‹æ€§èƒ½ï¼Œè®¡ç®—è°ƒæ•´åçš„Rå¹³æ–¹å€¼
heroes_count = len(y)  # è§‚æµ‹å€¼æ•°é‡ï¼Œç±»æ¯”ä¸ºæ­¦æ—ä¸­çš„è‹±é›„äººæ•°
techniques_count = X.shape[1]   # ç‰¹å¾æ•°é‡ï¼Œç±»æ¯”ä¸ºæ¨¡å‹ä¸­çš„æ­¦å­¦æŠ€å·§æ•°

# è°ƒæ•´åçš„Rå¹³æ–¹å€¼çš„è®¡ç®—è€ƒè™‘äº†æ¨¡å‹ä¸­çš„ç‰¹å¾æ•°é‡
adj_r_squared = 1 - (((1 - r_squared) * (heroes_count - 1)) / (heroes_count - techniques_count - 1))

# è¾“å‡ºè°ƒæ•´åçš„Rå¹³æ–¹å€¼
print("è°ƒæ•´åçš„Rå¹³æ–¹ï¼š", adj_r_squared)
```

## äº¤å‰éªŒè¯ä¸æ¨¡å‹é€‰æ‹©

###  ä»€ä¹ˆæ˜¯äº¤å‰éªŒè¯ï¼ˆCross Validationï¼‰ï¼Ÿ

äº¤å‰éªŒè¯æ˜¯ä¸€ç§è¯„ä¼°æœºå™¨å­¦ä¹ æ¨¡å‹æ³›åŒ–èƒ½åŠ›çš„æ–¹æ³•ï¼Œé€šè¿‡å°†æ•°æ®åˆ’åˆ†ä¸ºå¤šä¸ªâ€œè®­ç»ƒ-éªŒè¯â€å­é›†ï¼Œå¤šæ¬¡è®­ç»ƒè¯„ä¼°ï¼Œä»è€Œæ›´ç¨³å®šåœ°ä¼°è®¡æ¨¡å‹æ€§èƒ½ã€‚

#### ğŸ¯ ä¸ºä»€ä¹ˆä½¿ç”¨äº¤å‰éªŒè¯ï¼Ÿ

+ é˜²æ­¢ è¿‡æ‹Ÿåˆ æˆ– æ¬ æ‹Ÿåˆ
+ å¾—åˆ°æ›´ç¨³å®šçš„è¯„ä¼°ç»“æœ
+ æ”¯æŒè¶…å‚æ•°ä¼˜åŒ–å’Œæ¨¡å‹é€‰æ‹©

#### å¸¸è§çš„äº¤å‰éªŒè¯æ–¹æ³•

##### ï¼ˆ1ï¼‰K æŠ˜äº¤å‰éªŒè¯ï¼ˆK-Foldï¼‰

å°†æ•°æ®é›†åˆ’åˆ†ä¸º K ä¸ªå­é›†ï¼ˆfoldï¼‰ï¼Œæ¯æ¬¡ç”¨ 1 ä¸ªå­é›†ä½œä¸ºéªŒè¯é›†ï¼Œå…¶ä½™ K-1 ä¸ªä½œä¸ºè®­ç»ƒé›†ï¼Œé‡å¤ K æ¬¡ï¼Œæœ€åå¹³å‡æ€§èƒ½ã€‚

**ä¼˜ç‚¹**ï¼šé€‚ç”¨äºå°æ•°æ®é›†ï¼Œè¯„ä¼°ç¨³å®š
**ç¼ºç‚¹**ï¼šK è¶Šå¤§ï¼Œè®¡ç®—æˆæœ¬è¶Šé«˜

```python
from sklearn.model_selection import KFold, cross_val_score
from sklearn.linear_model import LogisticRegression
from sklearn.datasets import load_iris

X, y = load_iris(return_X_y=True)
model = LogisticRegression()

kf = KFold(n_splits=5, shuffle=True, random_state=42)
scores = cross_val_score(model, X, y, cv=kf)
print("æ¯æŠ˜å‡†ç¡®ç‡:", scores)
print("å¹³å‡å‡†ç¡®ç‡:", scores.mean())
```

##### ï¼ˆ2ï¼‰ç•™ä¸€æ³•ï¼ˆLeave-One-Out, LOOCVï¼‰

æ¯æ¬¡åªç”¨ä¸€ä¸ªæ ·æœ¬åšéªŒè¯ï¼Œå‰©ä¸‹çš„å…¨éƒ¨åšè®­ç»ƒï¼Œé‡å¤ n æ¬¡ï¼ˆn ä¸ºæ ·æœ¬æ•°ï¼‰ã€‚

**ä¼˜ç‚¹**ï¼šé€‚ç”¨äºå°æ•°æ®é‡
**ç¼ºç‚¹**ï¼šè®¡ç®—æˆæœ¬æé«˜

```python
from sklearn.model_selection import LeaveOneOut
loo = LeaveOneOut()
scores = cross_val_score(model, X, y, cv=loo)
```

##### ï¼ˆ3ï¼‰åˆ†å±‚ K æŠ˜ï¼ˆStratified K-Foldï¼‰

ç”¨äºåˆ†ç±»é—®é¢˜ï¼Œåœ¨æ¯ä¸ª fold ä¸­ä¿æŒå„ç±»æ ·æœ¬çš„æ¯”ä¾‹ä¸æ•´ä½“æ•°æ®ä¸€è‡´ã€‚

```python
from sklearn.model_selection import StratifiedKFold

skf = StratifiedKFold(n_splits=5, shuffle=True, random_state=42)
scores = cross_val_score(model, X, y, cv=skf)
```

##### ï¼ˆ4ï¼‰é‡å¤ K æŠ˜ï¼ˆRepeated K-Foldï¼‰

å¤šæ¬¡é‡å¤ K æŠ˜éªŒè¯ï¼Œé€‚åˆå°æ•°æ®é›†å‡å°‘å¶ç„¶æ€§ã€‚

```python
from sklearn.model_selection import RepeatedKFold
rkf = RepeatedKFold(n_splits=5, n_repeats=10, random_state=42)
```

### æ¨¡å‹é€‰æ‹©ï¼ˆModel Selectionï¼‰

åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸è¦æ¯”è¾ƒå¤šä¸ªæ¨¡å‹æˆ–å¤šä¸ª**è¶…å‚æ•°ç»„åˆ**ï¼Œé€‰å‡ºè¡¨ç°æœ€ä½³çš„æ¨¡å‹ã€‚

#### ğŸ¯ æ€ä¹ˆåšæ¨¡å‹é€‰æ‹©ï¼Ÿ

+ ä½¿ç”¨äº¤å‰éªŒè¯å¯¹æ¯ä¸ªæ¨¡å‹è¿›è¡Œè¯„åˆ†
+ æ¯”è¾ƒå¹³å‡å¾—åˆ†ï¼Œé€‰å‡ºæœ€ä¼˜æ¨¡å‹

### è¶…å‚æ•°è°ƒä¼˜ä¸ç½‘æ ¼æœç´¢

#### GridSearchCV ç¤ºä¾‹ï¼š

```python
from sklearn.model_selection import GridSearchCV

param_grid = {'C': [0.1, 1, 10]}
grid = GridSearchCV(LogisticRegression(), param_grid, cv=5)
grid.fit(X, y)

print("æœ€ä½³å‚æ•°ï¼š", grid.best_params_)
print("æœ€ä½³åˆ†æ•°ï¼š", grid.best_score_)
```

### äº¤å‰éªŒè¯ä¸è®­ç»ƒ/æµ‹è¯•åˆ’åˆ†çš„åŒºåˆ«

| é¡¹ç›®               | è®­ç»ƒ/æµ‹è¯•åˆ’åˆ†        | äº¤å‰éªŒè¯                |
|--------------------|----------------------|--------------------------|
| åˆ’åˆ†æ–¹å¼           | ä¸€æ¬¡æ€§åˆ’åˆ†           | å¤šæ¬¡äº¤å‰åˆ’åˆ†            |
| è¯„ä¼°ç¨³å®šæ€§         | å®¹æ˜“å—æ•°æ®åˆ’åˆ†å½±å“   | æ›´ç¨³å®šã€å…¨é¢            |
| æ˜¯å¦ç”¨äºå°æ•°æ®é›†   | ä¸æ¨è               | æ¨è                     |
| è®¡ç®—æˆæœ¬           | ä½                   | é«˜                       |

### äº¤å‰éªŒè¯æ–¹æ³•æ¯”è¾ƒ

| æ–¹æ³•               | ç‰¹ç‚¹                     | æ˜¯å¦æ¨è   |
|--------------------|--------------------------|------------|
| K æŠ˜äº¤å‰éªŒè¯        | é€šç”¨ã€ç¨³å®šã€ç»å…¸         | âœ… å¼ºçƒˆæ¨è |
| Stratified K-Fold  | é€‚åˆåˆ†ç±»ä»»åŠ¡              | âœ… æ›´ä¼˜é€‰æ‹© |
| Leave-One-Out      | ç¨³å®šä½†è®¡ç®—é‡å¤§            | âš ï¸ å°æ•°æ®ç”¨ |
| Repeated K-Fold    | å¤šæ¬¡éªŒè¯æ›´ç¨³å¥            | âœ…          |
| ShuffleSplit       | éšæœºåˆ’åˆ†å¤šæ¬¡              | âœ… é€‚åˆå¤§æ•°æ® |


## è®­ç»ƒé›† / éªŒè¯é›† / æµ‹è¯•é›†åˆ’åˆ†

### ä¸€ã€ä¸‰ç§æ•°æ®é›†çš„å®šä¹‰

| æ•°æ®é›†       | ä½œç”¨æè¿°                 |
|--------------|--------------------------|
| **è®­ç»ƒé›†**ï¼ˆTraining Setï¼‰   | ç”¨äºæ‹Ÿåˆæ¨¡å‹ï¼ˆæ¨¡å‹å­¦ä¹ çš„å¯¹è±¡ï¼‰ |
| **éªŒè¯é›†**ï¼ˆValidation Setï¼‰ | ç”¨äºè°ƒå‚å’Œæ¨¡å‹é€‰æ‹©ï¼Œä¸å‚ä¸è®­ç»ƒ |
| **æµ‹è¯•é›†**ï¼ˆTest Setï¼‰       | ç”¨äºæœ€ç»ˆè¯„ä¼°æ¨¡å‹æ³›åŒ–æ€§èƒ½       |

### äºŒã€ä¸ºä»€ä¹ˆè¦åˆ’åˆ†è¿™ä¸‰ç§æ•°æ®é›†ï¼Ÿ

+ é˜²æ­¢è¿‡æ‹Ÿåˆï¼šæ¨¡å‹åœ¨è®­ç»ƒé›†ä¸Šå­¦å¾—å¤ªå¥½ï¼Œæ³›åŒ–å·®ã€‚
+ éªŒè¯é›†ç”¨äºé€‰æ‹©æœ€ä½³è¶…å‚æ•°æˆ–æ¨¡å‹ã€‚
+ æµ‹è¯•é›†æ˜¯â€œæ¨¡å‹çš„æœŸæœ«è€ƒè¯•â€ï¼Œä¸èƒ½è¢«ç”¨äºè®­ç»ƒæˆ–è°ƒå‚ã€‚

### ä¸‰ã€å¸¸è§åˆ’åˆ†æ¯”ä¾‹

| åˆ’åˆ†æ–¹å¼                     | æ¯”ä¾‹ç¤ºä¾‹         |
|------------------------------|------------------|
| è®­ç»ƒ / æµ‹è¯•                  | 80% / 20%        |
| è®­ç»ƒ / éªŒè¯ / æµ‹è¯•           | 60% / 20% / 20%  |
| å°æ•°æ®é›†æ—¶ç”¨äº¤å‰éªŒè¯æ›¿ä»£éªŒè¯é›† | -                |

> âœ… æ³¨æ„ï¼šéªŒè¯é›†å’Œæµ‹è¯•é›†è¦äº’ä¸é‡å ï¼Œå¦åˆ™è¯„ä¼°ä¼šä¸å‡†ç¡®ã€‚

###  å››ã€Python å®ç°ç¤ºä¾‹ï¼ˆä½¿ç”¨ sklearnï¼‰

```python
from sklearn.model_selection import train_test_split
from sklearn.datasets import load_iris

X, y = load_iris(return_X_y=True)

# é¦–å…ˆåˆ’åˆ†è®­ç»ƒé›†å’Œä¸´æ—¶é›†ï¼ˆéªŒè¯+æµ‹è¯•ï¼‰
X_train, X_temp, y_train, y_temp = train_test_split(
    X, y, test_size=0.4, random_state=42
)

# å†ä»ä¸´æ—¶é›†ä¸­åˆ’åˆ†éªŒè¯é›†å’Œæµ‹è¯•é›†
X_val, X_test, y_val, y_test = train_test_split(
    X_temp, y_temp, test_size=0.5, random_state=42
)

print("è®­ç»ƒé›†å¤§å°:", X_train.shape)
print("éªŒè¯é›†å¤§å°:", X_val.shape)
print("æµ‹è¯•é›†å¤§å°:", X_test.shape)
```

###  äº”ã€å›¾ç¤ºç†è§£ï¼ˆ60%/20%/20%ï¼‰

```text
å®Œæ•´æ•°æ®é›†: â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
              â†“
è®­ç»ƒé›†ï¼ˆ60%ï¼‰ éªŒè¯é›†ï¼ˆ20%ï¼‰ æµ‹è¯•é›†ï¼ˆ20%ï¼‰
```

### å…­ã€ä¸‰ç§æ•°æ®åˆ’åˆ†æ–¹å¼æ¯”è¾ƒè¡¨æ ¼ï¼ˆMarkdown æºç ï¼‰

| æ•°æ®é›†ç±»å‹     | ç”¨é€”                           | æ˜¯å¦å‚ä¸è®­ç»ƒ | æ˜¯å¦ç”¨äºè°ƒå‚ | æ˜¯å¦ç”¨äºæœ€ç»ˆè¯„ä¼° |
|----------------|--------------------------------|--------------|--------------|------------------|
| è®­ç»ƒé›†         | æ‹Ÿåˆæ¨¡å‹å‚æ•°ï¼ˆå¦‚æƒé‡ï¼‰         | âœ… æ˜¯         | âŒ å¦         | âŒ å¦             |
| éªŒè¯é›†         | é€‰æ‹©æ¨¡å‹æˆ–è¶…å‚æ•°                | âŒ å¦         | âœ… æ˜¯         | âŒ å¦             |
| æµ‹è¯•é›†         | è¯„ä¼°æ³›åŒ–æ€§èƒ½ï¼ˆæœ€ç»ˆæŒ‡æ ‡ï¼‰        | âŒ å¦         | âŒ å¦         | âœ… æ˜¯             |





